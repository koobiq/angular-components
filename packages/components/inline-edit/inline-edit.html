@if (label()) {
    <div class="kbq-inline-edit__label">
        <ng-content select="kbq-label" />
    </div>
}

@if (mode() === 'view') {
    <ng-container *ngTemplateOutlet="viewModeTemplateRef().templateRef" />
} @else {
    <div class="kbq-inline-edit__overlay-anchor">
        <div #overlayOrigin cdkOverlayOrigin class="kbq-inline-edit__overlay-origin"></div>
    </div>

    <ng-template
        cdkConnectedOverlay
        cdkConnectedOverlayLockPosition
        [cdkConnectedOverlayOpen]="isEditMode()"
        [cdkConnectedOverlayOrigin]="overlayOrigin"
        [cdkConnectedOverlayWidth]="overlayWidth()"
        (attach)="onAttach()"
    >
        <div class="kbq-inline-edit__panel">
            <ng-container *ngTemplateOutlet="editModeTemplateRef().templateRef" />
        </div>
    </ng-template>
}
