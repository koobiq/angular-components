<button
    #popover="kbqPopover"
    kbq-button
    kbqPopover
    [disabled]="data.disabled"
    [kbq-pipe-states]="data"
    [kbqPopoverClass]="'kbq-pipe__popover'"
    [kbqPopoverContent]="content"
    [kbqPopoverFooter]="footer"
    [kbqPopoverPlacement]="placements.BottomLeft"
    [ngClass]="{ 'kbq-active': popover.isOpen }"
>
    <span class="kbq-pipe__name">{{ data.name }}</span>
    <span class="kbq-pipe__value">{{ data.value }}</span>
</button>

<ng-template #content>
    <kbq-form-field>
        <textarea
            kbqTextarea
            placeholder="Placeholder"
            rows="2"
            [canGrow]="false"
            [ngModel]="data.value"
            (keydown)="onCtrlEnter($event)"
            (ngModelChange)="onChange($event)"
        ></textarea>
    </kbq-form-field>
</ng-template>

<ng-template #footer>
    <button
        kbq-button
        [color]="'theme'"
        [disabled]="isEmpty && !viewValue"
        [kbqStyle]="'transparent'"
        (click)="onApply()"
    >
        <span>Применить</span>
        &nbsp;
        <span class="kbq-button_hot-key">Ctrl + Enter</span>
    </button>
</ng-template>

@if (!data.required && !isEmpty) {
    <button
        kbq-button
        class="kbq-pipe__delete"
        [disabled]="data.disabled"
        [kbq-pipe-states]="data"
        (click)="onDeleteOrClear()"
    >
        <i kbq-icon="kbq-xmark-s_16"></i>
    </button>
}
